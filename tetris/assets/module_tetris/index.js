System.register("chunks:///_virtual/config.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"ed401w0zPFEeLD9T8yDiFwN","config",void 0);e("Config",{blockWidth:34,blockHeight:-34,itemWidth:34,itemHeight:34,nextItemWidth:17,nextItemHeight:-17,spaceX:0,nextRow:4,nextCol:4,row:30,col:20,upSpeed:10,fastDownTime:100,middleDownTime:300,slowDownTime:700,fastShapeDownTime:16,speed:-500,animateDuration:.5,shapes:[[[[1,0],[1,1],[1,2],[2,2]],[[0,1],[0,2],[1,1],[2,1]],[[0,0],[1,0],[1,1],[1,2]],[[0,1],[1,1],[2,0],[2,1]]],[[[1,1],[1,0],[2,0],[2,1]]],[[[1,0],[1,1],[1,2],[1,3]],[[0,1],[1,1],[2,1],[3,1]]],[[[0,1],[1,1],[2,1],[1,2]],[[1,0],[1,1],[2,1],[1,2]],[[1,0],[1,1],[2,1],[0,1]],[[1,0],[1,1],[1,2],[0,1]]],[[[0,2],[1,0],[1,1],[1,2]],[[0,0],[0,1],[1,1],[2,1]],[[1,0],[1,1],[1,2],[2,0]],[[0,1],[1,1],[2,1],[2,2]]],[[[0,0],[1,0],[1,1],[2,1]],[[0,1],[0,2],[1,0],[1,1]]],[[[0,1],[1,1],[1,0],[2,0]],[[2,1],[1,1],[1,0],[2,2]]]]});t._RF.pop()}}}));

System.register("chunks:///_virtual/constants.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"72dd0/cIP1CwJk4mMaPZach","constants",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/enums.ts",["cc"],(function(O){var e;return{setters:[function(O){e=O.cclegacy}],execute:function(){e._RF.push({},"ef61e7sEEhLvq/tn4T3M0E8","enums",void 0);O("ItemColor",function(O){return O[O.DEFAULT=0]="DEFAULT",O[O.COLOR1=1]="COLOR1",O[O.COLOR2=2]="COLOR2",O[O.COLOR3=3]="COLOR3",O[O.COLOR4=4]="COLOR4",O[O.COLOR5=5]="COLOR5",O[O.COLOR6=6]="COLOR6",O[O.COLOR7=7]="COLOR7",O}({})),O("GameState",function(O){return O[O.GAME_INIT=0]="GAME_INIT",O[O.GAME_ING=1]="GAME_ING",O[O.GAME_STOP=2]="GAME_STOP",O}({})),O("KeyboardType",function(O){return O[O.LEFT=37]="LEFT",O[O.RIGHT=39]="RIGHT",O[O.ROTATE=38]="ROTATE",O[O.SPEED=40]="SPEED",O}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,a;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,a=e.Component}],execute:function(){var o;n._RF.push({},"8fba7Oy62ZJWo7/lwwjH+Iv","GameManager",void 0);var c=r.ccclass;r.property,e("GameManager",c("GameManager")(o=function(e){function n(){return e.apply(this,arguments)||this}t(n,e);var r=n.prototype;return r.start=function(){},r.update=function(e){},n}(a))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/main.ts",["./rollupPluginModLoBabelHelpers.js","cc","./config.ts","./enums.ts","./UI_Score.ts","./SceneDef.ts","./index.ts","./UI_Setting.ts","./UI_Pause.ts","./UI_Rewarded.ts"],(function(e){var t,i,s,o,n,r,a,h,l,p,c,u,v,d,f,m,g,S,C,b,x,w,P,M,y,U,D,I,N,k,R,A;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,o=e.assertThisInitialized,n=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,a=e._decorator,h=e.Prefab,l=e.SpriteFrame,p=e.Node,c=e.Label,u=e.Button,v=e.find,d=e.AudioSource,f=e.sys,m=e.input,g=e.Input,S=e.tween,C=e.instantiate,b=e.ParticleSystem2D,x=e.Sprite,w=e.UITransform,P=e.Component,M=e.v2,y=e.v3},function(e){U=e.Config},function(e){D=e.ItemColor},function(e){I=e.UI_Score},function(e){N=e.SceneUtil},function(e){k=e.screenMap},function(e){R=e.UI_Setting},function(e){A=e.UI_Pause},null],execute:function(){var E,O,T,L,Y,F,G,B,_,z,H,X,K,W,q,V,J,j,Q,Z,$,ee,te;r._RF.push({},"83fballzXpMqIEtBDOMRVUo","main",void 0);var ie=a.ccclass,se=a.property,oe=function(e){},ne=(e("main",(E=ie("main"),O=se({type:h}),T=se({type:h}),L=se({type:l}),Y=se({type:l}),F=se({type:p}),G=se({type:c}),B=se({type:p}),_=se({type:p}),z=se(u),H=se(u),E((W=t((K=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).items=[][U.col],t.shapes=[][U.col],t.currShape=[[],[],[]],t.lastPreviewShape=[],t.currColor=null,t.nextShape=[],t.nextColor=null,t.shapeTimer=null,t.default=[],t.score=0,t.overCallback=void 0,t.nextShapes=[][U.nextCol],t.moveShapes=[][U.nextCol],t.runSpeed=U.slowDownTime,t.enableBGM=!0,t.enableGameAudio=!0,t.tetrisUtils=void 0,t.moveIncrement=0,t.moveYIncrement=0,s(t,"box",W,o(t)),s(t,"partical",q,o(t)),s(t,"colors",V,o(t)),s(t,"previewColor",J,o(t)),s(t,"nextRowNode",j,o(t)),t.gameOverPosY=5,t.autoMoveNode=null,t.stepY=0,t.posX=0,t.isMoveDowning=!1,s(t,"scoreLabel",Q,o(t)),s(t,"nextContainer",Z,o(t)),s(t,"moveContainer",$,o(t)),s(t,"pause",ee,o(t)),s(t,"setting",te,o(t)),t.checkBoardUp=oe,t.gameState="runing",t.shouldRotateShape=!1,t.shouldFastDown=!1,t.startPos=0,t.startNextPos=0,t.shapeIndex=0,t.shapeDir=0,t.nextShapeIndex=0,t.nextShapeDir=0,t.currentLevel1=1,t.currentMap=void 0,t.currentMapRuningIndex=0,t.currentRowData=[],t.gameSpeed=5,t.rows=void 0,t.levelNode=void 0,t.gamePass=!1,t.gameOverPass=!1,t.line=void 0,t}i(t,e);var r=t.prototype;return r.start=function(){var e=this;this.getNodes(),this.setGameOverCallback((function(){v("Canvas/bg").getComponent(d).stop(),e.setKeyboardActive(!1),tgx.UIMgr.inst.showUI(I,(function(t){t.show(e.score,e.currentLevel1,e.currentMap,e.gameOverPass)}))}));var t=N.sceneParams;this.currentLevel1=null==t?void 0:t.level,this.currentMap=null==t?void 0:t.map,this.levelNode.string=""+this.currentLevel1,this.tetrisUtils=new ne(this.node.position),this.readConfig(),this.initEnv()},r.setLine=function(){var e=f.localStorage.getItem("GAMEREWARDED")||8;e>0?(this.line.getChildByName("1").active=!0,this.line.getChildByPath("1/Label").getComponent(c).string=""+e):this.line.getChildByName("1").active=!1},r.getNodes=function(){var e=this;this.rows=v("Canvas/up/rows/Label").getComponent(c),this.levelNode=v("Canvas/up/level/level").getComponent(c),v("Canvas/DialogRewarded").active=!1,this.line=v("Canvas/up/line"),this.line.on(u.EventType.CLICK,(function(){f.localStorage.getItem("GAMEREWARDED");e.forceLine()}))},r.computedRows=function(){this.rows.string=""+(this.currentMap.length-this.currentMapRuningIndex)},r.readConfig=function(){f.localStorage.getItem("GAMESPEED");var e="false"!==f.localStorage.getItem("BGM");e!==this.enableBGM&&(this.enableBGM=e,e?v("Canvas/bg").getComponent(d).play():v("Canvas/bg").getComponent(d).stop());this.enableGameAudio="false"!==f.localStorage.getItem("GAMEAUDIO"),this.gameSpeed=Number(f.localStorage.getItem("GAMESPEED"))||5},r.forceLine=function(){this.nextShapeIndex=2,this.nextShapeDir=0,this.nextShape=this.tetrisUtils.copyShape(U.shapes[2][0]),this.nextColor=Math.floor(Math.random()*this.colors.length)+1,this.renderNextShape()},r.changeGameState=function(e){if(this.gameState=e,"stop"==e){if(this.checkBoardUp=oe,this.enableBGM)v("Canvas/bg").getComponent(d).stop();this.setKeyboardActive(!1)}else{if(this.setKeyboardActive(!0),this.enableBGM)v("Canvas/bg").getComponent(d).play();this.checkBoardUp=this.gamePass?oe:this._checkboardMoveUp}},r.changeUpState=function(e){this.checkBoardUp=e?this._checkboardMoveUp:oe},r.update=function(e){this.checkBoardUp(e)},r.setGameOverCallback=function(e){this.overCallback=e},r.setKeyboardActive=function(e){e?(m.on(g.EventType.TOUCH_START,this.touchStartCallback,this),m.on(g.EventType.TOUCH_MOVE,this.touchMoveCallback,this),m.on(g.EventType.TOUCH_END,this.touchEndCallback,this)):(m.off(g.EventType.TOUCH_START,this.touchStartCallback,this),m.off(g.EventType.TOUCH_MOVE,this.touchMoveCallback,this),m.off(g.EventType.TOUCH_END,this.touchEndCallback,this))},r.getNextShape=function(){var e=this;this.setKeyboardActive(!1),this.changeUpState(!1),this.moveContainer.active=!0,this.posX=Math.floor(U.col/2);var t=this.tetrisUtils.coordToPosition(this.posX,0);this.moveContainer.setPosition(t),this.getCurrShapeAndColor(),this.renderMove();var i=this.tetrisUtils.coordToPosition(this.posX,this.gameOverPosY);this.renderAllRightPreviewShape(),this.stepY<0&&(i=this.tetrisUtils.coordToPosition(this.posX,this.gameOverPosY+this.stepY)),S(this.moveContainer).to(U.animateDuration,{position:i},{easing:"quadInOut",onComplete:function(){e.isMoveDowning=!1,e.changeUpState(!0),e.checkGameOver(),e.setKeyboardActive(!0)}}).start(),this.renderNextShape()},r.checkGameOver=function(){var e=this.tetrisUtils.copyShape(this.currShape);if(this.tetrisUtils.shapeAddByNumber(e,U.col/2,this.gameOverPosY+1),!this.isMove(e))return this.changeGameState("stop"),void this.overCallback()},r.clearRowShape=function(){var e=this;new Promise((function(t,i){for(var s=new Set,o=-1,r=[],a=U.row-1;a>=0;a--){for(var h=0,l=0;l<U.col;l++)e.items[a][l]!=D.DEFAULT&&h++;if(h==U.col){s.add(a),-1==o&&(o=a);var p=a*U.blockHeight-U.blockHeight/2,c=U.blockWidth/2;for(l=0;l<U.col;l++){var u=C(e.partical);e.node.addChild(u),u.getComponent(b).spriteFrame=e.colors[e.items[a][l]-1],r.push(u),u.setPosition(l*U.blockWidth+c,p),e.items[a][l]=D.DEFAULT}}}-1!=o?(e.renderShape(),e.moveContainer.active=!1,e.enableGameAudio&&tgx.AudioMgr.inst.playOneShot("sounds/chimes",1),e.schedule((function(){for(var i,a=n(r);!(i=a()).done;){var h=i.value;e.node.removeChild(h)}t({a:o,set:s})}),.8)):i()})).then((function(t){var i=t.a,s=t.set;e.autoDown(i,s.size,(function(){var t=i;e.items[0]=e.default,e.renderShape(),new Promise((function(i,s){for(var o=0,n=0,r=function(t){for(var s=function(s){if(e.items[t][s]!==D.DEFAULT){var r=e.checkDownSingle(s,t);if(r!=t){var a=e.items[t][s];e.setSingleNode(s,t,D.DEFAULT,!1),e.setSingleNode(s,r,a,!1),n+=1;var h=e.shapes[t][s],l=h.position.clone();S(h).to(.5,{position:y(l.x,r*U.blockHeight,0)},{easing:"quadInOut",onComplete:function(h){e.setSingleNode(s,r,a),e.setSingleNode(s,t,D.DEFAULT),e.shapes[t][s].setPosition(l),(o+=1)==n&&i(!0)}}).start()}}},r=0;r<U.col;r++)s(r)},a=t;a>=0;a--)r(a);0==n&&0==o&&i(!0)})).then((function(){e.score+=20*s.size*e.gameSpeed+20*s.size,e.scoreLabel.string=""+e.score,e.renderShape(),e.clearRowShape()})).catch((function(e){}))}))}),(function(){e.gamePass&&e.checkMapEmpty()?(e.gameOverPass=!0,e.overCallback()):e.getNextShape()}))},r.checkMapEmpty=function(){for(var e=!0,t=0;t<this.items.length;t++)if(!(e=this.items[t].every((function(e){return 0==e}))))return e;return e},r.setSingleNode=function(e,t,i,s){void 0===s&&(s=!0),this.items[t][e]=i,s&&(this.shapes[t][e].getComponent(x).spriteFrame=i==D.DEFAULT?null:this.colors[i-1])},r.checkDownSingle=function(e,t){for(var i=t,s=!0;i+1<U.row&&s;)this.items[i+1][e]===D.DEFAULT?i+=1:s=!1;return i},r.autoDown=function(e,t,i){return i()},r.moveShape=function(e,t){for(var i=0;i<e.length;i++)e[i][0]+=t[0],e[i][1]+=t[1]},r.isMove=function(e){for(var t=!0,i=0;i<e.length;i++){var s=e[i];(s[0]<0||s[1]<0||s[1]>=U.row||s[0]>=U.col||this.items[s[1]][s[0]]!==D.DEFAULT)&&(t=!1)}return t},r.changeShape=function(e,t){void 0===t&&(t=!1);var i=!1,s=this.tetrisUtils.copyShape(this.currShape);return this.tetrisUtils.shapeAddByNumber(s,this.posX,this.gameOverPosY),e(s),this.isMove(s)&&(t&&e(this.currShape),i=!0),i},r.shapeLeftOrRightOrDown=function(e){var t=this;return this.changeShape((function(i){t.moveShape(i,e)}))},r.shapeRotate=function(){var e,t=U.shapes[this.shapeIndex].length,i=(this.shapeDir+1)%t;e=U.shapes[this.shapeIndex][i];var s=this.tetrisUtils.copyShape(e);return this.tetrisUtils.shapeAddByNumber(s,this.posX,this.gameOverPosY),this.enableGameAudio&&tgx.AudioMgr.inst.playOneShot("sounds/sound_pop",1),!!this.isMove(s)},r.touchStartCallback=function(e){this.shouldRotateShape=!0},r.touchMoveCallback=function(e){this.shouldRotateShape=!1;var t=e.getDeltaX(),i=e.getDeltaY();if(this.moveIncrement+=t,Math.abs(t)>Math.abs(i)){if(Math.abs(this.moveIncrement)>39){this.moveIncrement=0,this.moveYIncrement=0;var s=t/Math.abs(t);if(this.shapeLeftOrRightOrDown([s,0])){var o=this.moveContainer.position;this.moveContainer.setPosition(o.x+s*U.blockWidth,o.y,o.z),this.posX+=s,this.renderPreviewShape()}}}else Math.abs(i)>5&&(this.moveYIncrement+=i,this.moveYIncrement<-25&&(this.shouldFastDown=!0,this.moveYIncrement=0))},r.touchEndCallback=function(e){if(this.shouldRotateShape&&this.shapeRotate()){var t=U.shapes[this.shapeIndex];this.shapeDir+=1,this.shapeDir%=t.length;var i=U.shapes[this.shapeIndex][this.shapeDir];this.currShape=this.tetrisUtils.copyShape(i),this.renderMove(),this.renderPreviewShape()}else this.shouldFastDown&&!this.isMoveDowning&&this.moveDown();this.shouldFastDown=!1},r.getCurrShapeAndColor=function(){this.currShape=this.nextShape,this.currColor=this.nextColor,this.shapeIndex=this.nextShapeIndex,this.shapeDir=this.nextShapeDir,this.nextShapeIndex=Math.floor(Math.random()*U.shapes.length),this.nextShapeDir=Math.floor(Math.random()*U.shapes[this.nextShapeIndex].length),this.nextShape=this.tetrisUtils.copyShape(U.shapes[this.nextShapeIndex][this.nextShapeDir]),this.nextColor=Math.floor(Math.random()*this.colors.length)+1},r.initEnv=function(){var e=this;this.setKeyboardActive(!1),this.pause.node.on(u.EventType.CLICK,(function(t){e.changeGameState("stop"),tgx.UIMgr.inst.showUI(A,(function(t){t.show((function(){e.changeGameState("runing")}))}))})),this.setting.node.on(u.EventType.CLICK,(function(t){e.changeGameState("stop"),tgx.UIMgr.inst.showUI(R,(function(t){t.setCloseCb((function(){e.readConfig(),e.changeGameState("runing")}))}))})),this.items=[],this.shapes=[],this.node.removeAllChildren(),this.score=0;for(var t=0;t<U.col;t++)this.default.push(D.DEFAULT);this.initNext(),this.initLevelMap(),this.initNextRowNode(),this.initMove(),null!==this.shapeTimer&&clearInterval(this.shapeTimer),this.currShape=[],this.currColor=D.DEFAULT,this.scoreLabel.string=""+this.score,this.renderShape(),this.setKeyboardActive(!0),this.getNextShape()},r.initNextRowNode=function(){var e=0;this.startNextPos=this.nextRowNode.position.y;for(var t=0;t<U.col;t++,e+=U.blockWidth){var i=C(this.box);this.nextRowNode.addChild(i),i.setPosition(e,0)}this.renderNextRowNode()},r.renderNextRowNode=function(){var e=this;this.currentMapRuningIndex!=this.currentMap.length?(this.currentRowData=this.currentMap[this.currentMapRuningIndex],this.currentMapRuningIndex++,this.nextRowNode.children.forEach((function(t,i){t.getComponent(x).spriteFrame=0==e.currentRowData[i]?null:e.colors[D.COLOR1-1]})),this.computedRows()):this.gamePass=!0},r.initLevelMap=function(){var e=0,t=0,i=U.spaceX;this.autoMoveNode=C(this.box),this.node.addChild(this.autoMoveNode),this.autoMoveNode.active=!1;for(var s=0;s<U.row;s++,t+=U.blockHeight){this.items.push(JSON.parse(JSON.stringify(k[s]))),this.shapes.push([]),e=0;for(var o=0;o<U.col;o++,e+=U.blockWidth+i){var n=C(this.box);this.node.addChild(n),n.setPosition(e,t),this.shapes[s].push(n)}}},r.initMove=function(){this.moveShapes=[],this.moveContainer.removeAllChildren();for(var e=U.spaceX,t=0,i=0,s=0;s<U.nextRow;s++,i+=U.blockHeight){t=0,this.moveShapes.push([]);for(var o=0;o<U.nextCol;o++,t+=U.blockWidth+e){var n=C(this.box);this.moveContainer.addChild(n),n.setPosition(t,i),this.moveShapes[s].push(n)}}},r.renderMove=function(){var e=this;this.clearMoveShape();var t=this.moveShapes;this.currShape.forEach((function(i){var s=i[0],o=i[1];t[o][s].getComponent(x).spriteFrame=e.colors[e.currColor-1]}))},r.clearMoveShape=function(){for(var e=0;e<U.nextRow;e++)for(var t=0;t<U.nextCol;t++)this.moveShapes[e][t].getComponent(x).spriteFrame=null},r.moveDown=function(){var e=this;this.isMoveDowning=!0,this.changeUpState(!1);var t=this.tetrisUtils.coordToPosition(this.posX,this.gameOverPosY+this.stepY);S(this.moveContainer).to(U.animateDuration,{position:t},{easing:"quadInOut",onComplete:function(){e.fillPreviewShape(),e.clearRowShape()}}).start()},r.renderShape=function(){for(var e=0;e<U.row;e++)for(var t=0;t<U.col;t++){var i=null;this.items[e][t]>0&&(i=this.colors[this.items[e][t]-1]),this.shapes[e][t].getComponent(x).spriteFrame=i}},r.clearPreviewShape=function(){for(var e=0;e<this.lastPreviewShape.length;e++)this.shapes[this.lastPreviewShape[e][1]][this.lastPreviewShape[e][0]].getComponent(x).spriteFrame=null},r.renderPreviewShape=function(){this.clearPreviewShape();var e,t,i=this.tetrisUtils.copyShape(this.currShape);this.tetrisUtils.shapeAddByNumber(i,this.posX,this.gameOverPosY),this.stepY=0;for(var s=0;s<i.length;s++)i[s][0]+=0,i[s][1]+=1;for(;this.isMove(i);){this.stepY+=1;for(s=0;s<i.length;s++)i[s][0]+=0,i[s][1]+=1}this.lastPreviewShape.length=0;for(s=0;s<this.currShape.length;s++)e=this.currShape[s][0]+this.posX,t=this.currShape[s][1]+this.stepY+this.gameOverPosY,this.lastPreviewShape.push([e,t]),this.shapes[t][e].getComponent(x).spriteFrame=this.previewColor},r.renderAllRightPreviewShape=function(){this.clearPreviewShape();var e,t,i=this.tetrisUtils.copyShape(this.currShape);this.tetrisUtils.shapeAddByNumber(i,this.posX,this.gameOverPosY),this.stepY=0;for(var s=0;s<i.length;s++)i[s][0]+=0,i[s][1]+=1;for(;this.isMove(i);){this.stepY+=1;for(s=0;s<i.length;s++)i[s][0]+=0,i[s][1]+=1}if(0==this.stepY){for(s=0;s<i.length;s++)i[s][1]-=1;for(;!this.isMove(i)&&this.stepY>-this.gameOverPosY;){this.stepY-=1;for(s=0;s<i.length;s++)i[s][1]-=1}}this.lastPreviewShape.length=0;for(s=0;s<this.currShape.length;s++)e=this.currShape[s][0]+this.posX,t=this.currShape[s][1]+this.stepY+this.gameOverPosY,this.lastPreviewShape.push([e,t]),this.shapes[t][e].getComponent(x).spriteFrame=this.previewColor},r.fillPreviewShape=function(){for(var e,t,i=0;i<this.lastPreviewShape.length;i++)e=this.lastPreviewShape[i][0],t=this.lastPreviewShape[i][1],this.setSingleNode(e,t,this.currColor);this.lastPreviewShape.length=0},r._checkboardMoveUp=function(e){var t=this.node.position,i=this.nextRowNode.position;this.startPos+=2*this.gameSpeed*e,this.startPos>-U.blockHeight&&(this.startPos=0,this.tetrisUtils.setCheckboardPosY(this.startPos),this.upStep()),this.tetrisUtils.setCheckboardPosY(this.startPos),this.node.setPosition(t.x,this.startPos),this.nextRowNode.setPosition(i.x,this.startNextPos+this.startPos)},r.upStep=function(){var e=null;this.clearPreviewShape(),this.lastPreviewShape=[];for(var t=1;t<U.row;t++)for(var i=0;i<U.col;i++)this.items[t-1][i]=this.items[t][i],e=this.items[t-1][i],this.shapes[t-1][i].getComponent(x).spriteFrame=e==D.DEFAULT?null:this.colors[e-1];for(var s=0;s<U.col;s++)this.setSingleNode(s,U.row-1,this.currentRowData[s]);this.renderNextRowNode(),this.checkGameOver(),this.renderPreviewShape()},r.initNext=function(){this.nextShapes=[],this.nextShapeIndex=Math.floor(Math.random()*U.shapes.length),this.nextShapeDir=Math.floor(Math.random()*U.shapes[this.nextShapeIndex].length),this.nextShape=this.tetrisUtils.copyShape(U.shapes[this.nextShapeIndex][this.nextShapeDir]),this.nextColor=Math.floor(Math.random()*this.colors.length)+1;for(var e=0,t=0,i=0;i<U.nextRow;i++,t+=U.nextItemHeight){e=0,this.nextShapes.push([]);for(var s=0;s<U.nextCol;s++,e+=U.nextItemWidth){var o=C(this.box);o.getComponent(w).setContentSize(U.nextItemWidth,U.nextItemHeight),this.nextContainer.addChild(o),o.setPosition(e,t),this.nextShapes[i].push(o)}}},r.renderNextShape=function(){var e=this;this.clearNextShape();var t=this.nextShapes;this.nextShape.forEach((function(i){var s=i[0],o=i[1];t[o][s].getComponent(x).spriteFrame=e.colors[e.nextColor-1]}))},r.clearNextShape=function(){for(var e=0;e<U.nextRow;e++)for(var t=0;t<U.nextCol;t++)this.nextShapes[e][t].getComponent(x).spriteFrame=null},r.gameStop=function(){},t}(P)).prototype,"box",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(K.prototype,"partical",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(K.prototype,"colors",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),J=t(K.prototype,"previewColor",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(K.prototype,"nextRowNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(K.prototype,"scoreLabel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(K.prototype,"nextContainer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(K.prototype,"moveContainer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(K.prototype,"pause",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=t(K.prototype,"setting",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=K))||X)),function(){function e(e){this.checkboardPos=void 0,this.checkboardPos=M(e.x,e.y)}var t=e.prototype;return t.coordToPosition=function(e,t){return y(e*U.blockWidth+this.checkboardPos.x,t*U.blockHeight+this.checkboardPos.y,0)},t.copyShape=function(e){for(var t=[],i=0;i<e.length;i++)t.push([e[i][0],e[i][1]]);return t},t.shapeAdd=function(e,t){for(var i=0;i<e.length;i++)e[i][0]+=t.x,e[i][1]+=t.y},t.shapeAddByNumber=function(e,t,i){for(var s=0;s<e.length;s++)e[s][0]+=t,e[s][1]+=i},t.shapeDiv=function(e,t){for(var i=0;i<e.length;i++)e[i][0]-=t.x,e[i][1]-=t.y},t.setCheckboardPosY=function(e){this.checkboardPos.y=e},e}());r._RF.pop()}}}));

System.register("chunks:///_virtual/module_tetris",["./constants.ts","./panel.ts","./GameManager.ts","./TetrisGameAudioMgr.ts","./config.ts","./enums.ts","./main.ts","./setting.ts","./tile.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/panel.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var n,a,t,o;return{setters:[function(r){n=r.inheritsLoose},function(r){a=r.cclegacy,t=r._decorator,o=r.Component}],execute:function(){var e;a._RF.push({},"61870aVZkxLCLrUYUBsIRPb","panel",void 0);var c=t.ccclass;t.property,r("Panel",c("Panel")(e=function(r){function a(){for(var n,a=arguments.length,t=new Array(a),o=0;o<a;o++)t[o]=arguments[o];return(n=r.call.apply(r,[this].concat(t))||this).panelArray=[8,8],n.twoArray=[],n.cells=[],n.canvasInfo={},n.isHasPreEle=!1,n.tableId="body-table",n.preObjArray=[],n.canvasRowObj={},n.canvasColObj={},n.cellInfo={width:60,height:60},n}n(a,r);var t=a.prototype;return t.init=function(){for(var r=this.panelArray[0],n=this.panelArray[1],a=0;a<r;a++)this.canvasRowObj[a]=[];for(var t=0;t<n;t++)this.canvasColObj[t]=[];for(var o=0;o<r;o++){for(var e=[],c=0;c<n;c++)e.push(0);this.twoArray.push(e)}this.bindEvent()},t.bindEvent=function(){},t.isInlay=function(r){void 0===r&&(r=[[]]);var n=!0;try{for(var a=0;a<r.length;a++){var t=r[a],o=this.twoArray[t[0]],e=o[t[1]];if(o&&1==e||null==e){n=!1;break}}return n}catch(r){return console.warn("error",r),!1}},t.eleIsInlay=function(r){void 0===r&&(r=[[]]);for(var n=!1,a=r.length,t=r[0].length,o=0;o<=this.twoArray.length-a;o++)for(var e=this.twoArray[o],c=0;c<=e.length-t;c++){if(1!==e[c]){for(var i=0,s=this.mapPosOfCanvas(r,o,c),f=0;f<s.length;f++){var l=s[f],h=l[0],u=l[1];if(1==this.twoArray[h][u])break;i++}if(i==s.length){n=!0;break}}if(n)break}return n},t.setPreEle=function(r,n){var a=this;r.forEach((function(r){var n=r[0],t=r[1];a.preObjArray[n]?a.preObjArray[n].push(t):a.preObjArray[n]=[t]})),this.isHasPreEle=!0},t.setTranCell=function(r,n,a){var t=this;r.forEach((function(r){t.twoArray[r].forEach((function(r,n){}))})),n.forEach((function(r){t.twoArray.forEach((function(r,n){}))}))},t.removeTranCell=function(){},t.resetPreEle=function(){this.preObjArray=[],this.isHasPreEle=!1},t.setCellEle=function(r,n){var a=this;r.forEach((function(r){var n=r[0],t=r[1];a.twoArray[n][t]=1,a.canvasRowObj[n]?a.canvasRowObj[n].push(t):a.canvasRowObj[n]=[t],a.canvasColObj[t]?a.canvasColObj[t].push(n):a.canvasColObj[t]=[n]}))},t.compDistance=function(r,n){void 0===r&&(r=730),void 0===n&&(n=165);var a=this.cells.map((function(a){return Math.pow(Math.abs(a.left-r),2)+Math.pow(Math.abs(a.top-n),2)})),t=Math.min.apply(Math,a),o=a.findIndex((function(r){return r==t}));return this.cells[o]},t.mapPosOfCanvas=function(r,n,a){var t=[];return r.forEach((function(r,o){r.forEach((function(r,e){1==r&&t.push([n+o,a+e])}))})),t},t.isRemoveCell=function(r){var n=this,a=this.panelArray[0],t=this.panelArray[1],o=[],e=[],c={},i={};return r.forEach((function(r){var n=r[0],a=r[1];c[n]?c[n].push(a):c[n]=[a],i[a]?i[a].push(n):i[a]=[n]})),Object.keys(c).forEach((function(r){n.twoArray[r].filter((function(r){return 1==r})).length>=t&&o.push(r)})),Object.keys(i).forEach((function(r){var t=0;n.twoArray.forEach((function(n){t+=n[r]})),t>=a&&e.push(r)})),!(!o.length&&!e.length)&&[o,e]},t.removeCellByRowCol=function(r,n){var a=this;void 0===r&&(r=[]),void 0===n&&(n=[]),r.forEach((function(r){var n=a.twoArray[r];n.forEach((function(r,a){n[a]=0})),a.canvasRowObj[r]=[],Object.keys(a.canvasColObj).forEach((function(n){var t=a.canvasColObj[n].findIndex((function(n){return n==r}));a.canvasColObj[n].splice(t,1)}))})),n.forEach((function(r){a.twoArray.forEach((function(n,a){n[r]=0})),a.canvasColObj[r]=[],Object.keys(a.canvasRowObj).forEach((function(n){var t=a.canvasRowObj[n].findIndex((function(n){return n==r}));a.canvasRowObj[n].splice(t,1)}))}))},t.start=function(){},a}(o))||e);a._RF.pop()}}}));

System.register("chunks:///_virtual/setting.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UI_Setting.ts"],(function(t){var e,n,i,r,o,s,c,a,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,c=t.Button,a=t.Component},function(t){u=t.UI_Setting}],execute:function(){var l,p,g,f,y;o._RF.push({},"43f98JJotVHW4HlbBRFHV0f","setting",void 0);var h=s.ccclass,v=s.property;t("setting",(l=h("setting"),p=v(c),l((y=e((f=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o))||this,i(e,"setting",y,r(e)),e}n(e,t);var o=e.prototype;return o.start=function(){this.setting.node.on(c.EventType.CLICK,(function(){tgx.UIMgr.inst.showUI(u)}))},o.update=function(t){},e}(a)).prototype,"setting",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=f))||g));o._RF.pop()}}}));

System.register("chunks:///_virtual/TetrisGameAudioMgr.ts",["cc","./ModuleDef.ts"],(function(t){var i,n;return{setters:[function(t){i=t.cclegacy},function(t){n=t.ModuleDef}],execute:function(){i._RF.push({},"8b97cV/JfpKq7OUlGp51FlG","TetrisGameAudioMgr",void 0);var u=n.TETRIS;t("TetrisGameAudioMgr",function(){function t(){}return t.playOneShot=function(t,i){void 0===i&&(i=1),tgx.AudioMgr.inst.playOneShot(t,i,u)},t.play=function(t,i){void 0===i&&(i=1),tgx.AudioMgr.inst.play(t,i,u)},t.stop=function(){tgx.AudioMgr.inst.stop()},t.pause=function(){tgx.AudioMgr.inst.pause()},t.resume=function(){tgx.AudioMgr.inst.audioSource.play()},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/tile.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,n,e,i,s,c,r,a;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,i=t.input,s=t.Input,c=t.Vec2,r=t.Vec3,a=t.Component}],execute:function(){var u;n._RF.push({},"ded10zxkERDVbNs9sstoolA","tile",void 0);var h=e.ccclass;e.property,t("tile",h("tile")(u=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).startDistance=c.ZERO,o}o(n,t);var e=n.prototype;return e.start=function(){},e.onLoad=function(){this.bindEvents()},e.onDestroy=function(){i.off(s.EventType.TOUCH_START,this.onTouchStart,this),i.off(s.EventType.TOUCH_MOVE,this.onTouchMove,this),i.off(s.EventType.TOUCH_END,this.onTouchEnd,this)},e.onTouchStart=function(t){var o=this.node.worldPosition;c.subtract(this.startDistance,t.getLocation(),new c(o.x,o.y)),console.log("worldPosition",this.node.worldPosition),console.log("event.getLocation",t.getLocation()),console.log("diff",this.startDistance)},e.onTouchMove=function(t){var o=t.getLocation();this.node.setWorldPosition(new r(o.x-this.startDistance.x,o.y-this.startDistance.x))},e.onTouchEnd=function(t){console.log("touch end",t.getLocation())},e.bindEvents=function(){i.on(s.EventType.TOUCH_START,this.onTouchStart,this),i.on(s.EventType.TOUCH_MOVE,this.onTouchMove,this),i.on(s.EventType.TOUCH_END,this.onTouchEnd,this)},e.update=function(t){},n}(a))||u);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/module_tetris', 'chunks:///_virtual/module_tetris'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});